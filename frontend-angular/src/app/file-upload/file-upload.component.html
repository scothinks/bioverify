<div class="file-upload-container">
  <mat-card class="list-card">
    <mat-card-header class="enhanced-header">
      <div class="header-content">
        <div class="title-section">
          <mat-icon class="header-icon">cloud_upload</mat-icon>
          <div class="title-text">
            <mat-card-title>Master List Uploader</mat-card-title>
            <mat-card-subtitle>Upload employee data via CSV or Excel files</mat-card-subtitle>
          </div>
        </div>
      </div>
    </mat-card-header>
    <mat-card-content class="enhanced-content">

      <div *ngIf="uploadSummary; else uploadView" class="summary-container">
        <div class="summary-icon-container" [ngClass]="isError ? 'error' : 'success'">
          <mat-icon>{{ isError ? 'error_outline' : 'check_circle_outline' }}</mat-icon>
        </div>
        <h2>{{ uploadMessage }}</h2>
        
        <div class="summary-stats">
          <div class="summary-stat">
            <span class="stat-value">{{ uploadSummary.newRecordsCreated }}</span>
            <span class="stat-label">New Records Created</span>
          </div>
          <div class="summary-stat">
            <span class="stat-value">{{ uploadSummary.existingRecordsUpdated }}</span>
            <span class="stat-label">Records Updated</span>
          </div>
        </div>

        <div *ngIf="uploadSummary.recordsRequiringReverificationIds.length > 0" class="reverification-actions">
          <h3>Re-verification Required</h3>
          <p>
            <strong>{{ uploadSummary.recordsRequiringReverificationIds.length }}</strong> records have data mismatches and require re-verification.
          </p>
          <div class="action-buttons">
            <button mat-flat-button class="primary-button" (click)="onViewRecordsToVerify()">
              <mat-icon>visibility</mat-icon> View Records
            </button>
            <button mat-stroked-button color="accent" (click)="onNotifyRecords()">
              <mat-icon>notifications</mat-icon> Notify All
            </button>
          </div>
        </div>
        <button mat-stroked-button class="upload-another-button" (click)="resetUpload()">
          <mat-icon>refresh</mat-icon>
          Upload Another File
        </button>
      </div>

      <ng-template #uploadView>
        <div class="upload-area">
          <div class="file-dropzone" (click)="fileInput.click()">
            <input hidden #fileInput type="file" (change)="onFileSelected($event)" accept=".csv, .xlsx, .xls">
            <mat-icon class="drop-icon">upload_file</mat-icon>
            <p *ngIf="!hasFileSelected">Click to browse or drag & drop a file here</p>
            <p *ngIf="hasFileSelected">File ready for upload</p>
            <span class="file-types">Supported formats: CSV, XLSX, XLS</span>
          </div>

          <div *ngIf="hasFileSelected && !isUploading" class="file-info-chip">
            <mat-icon>description</mat-icon>
            <span class="file-name">{{ fileName }} ({{ fileSize }})</span>
            <button mat-icon-button (click)="resetUpload()" matTooltip="Remove file">
              <mat-icon>close</mat-icon>
            </button>
          </div>
          
          <div *ngIf="isUploading" class="progress-container">
            <span class="progress-text">Uploading "{{ fileName }}"...</span>
            <mat-progress-bar [value]="uploadProgress" mode="determinate"></mat-progress-bar>
            <span class="progress-percent">{{ uploadProgress }}%</span>
          </div>

          <button mat-flat-button class="primary-button upload-button" 
                  [disabled]="!hasFileSelected || isUploading || uploadProgress > 0" 
                  (click)="uploadFile()">
            <mat-icon>cloud_upload</mat-icon>
            Upload and Process File
          </button>
        </div>
      </ng-template>

    </mat-card-content>
  </mat-card>
</div>