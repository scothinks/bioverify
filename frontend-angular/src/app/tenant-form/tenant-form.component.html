<div class="tenant-form-container">
  <mat-card class="form-card">
    <mat-card-header class="enhanced-header">
      <div class="header-content">
        <div class="title-section">
          <mat-icon class="header-icon">{{ isEditMode ? 'edit' : 'add_business' }}</mat-icon>
          <div class="title-text">
            <mat-card-title>{{ isEditMode ? 'Edit Tenant' : 'Create New Tenant' }}</mat-card-title>
            <mat-card-subtitle>{{ isEditMode ? 'Update the details for ' + tenant?.name : 'Add a new tenant to the platform' }}</mat-card-subtitle>
          </div>
        </div>
      </div>
    </mat-card-header>
    
    <mat-card-content class="enhanced-content">
      <form [formGroup]="tenantForm" (ngSubmit)="onSubmit()" class="tenant-form-grid">
        
        <!-- Basic Information Section -->
        <h3 class="section-title">Basic Information</h3>
        <mat-divider></mat-divider>

        <mat-form-field appearance="outline">
          <mat-label>Tenant Name</mat-label>
          <input matInput formControlName="name" placeholder="e.g., Osun State Government">
          <mat-error>{{ getErrorMessage('name') }}</mat-error>
        </mat-form-field>
  
        <mat-form-field appearance="outline">
          <mat-label>State Code</mat-label>
          <input matInput formControlName="stateCode" placeholder="e.g., OS" maxlength="2" style="text-transform: uppercase;">
          <mat-error>{{ getErrorMessage('stateCode') }}</mat-error>
        </mat-form-field>
  
        <mat-form-field appearance="outline" class="full-width-field">
          <mat-label>Subdomain</mat-label>
          <input matInput formControlName="subdomain" placeholder="e.g., osun">
          <mat-hint *ngIf="isEditMode; else newHint">Subdomain cannot be changed after creation.</mat-hint>
          <ng-template #newHint><mat-hint>Lowercase letters, numbers, and hyphens only.</mat-hint></ng-template>
          <mat-error>{{ getErrorMessage('subdomain') }}</mat-error>
        </mat-form-field>
  
        <mat-form-field appearance="outline" class="full-width-field">
          <mat-label>Description (Optional)</mat-label>
          <textarea matInput formControlName="description" placeholder="Brief description of the tenant..." rows="2"></textarea>
          <mat-error>{{ getErrorMessage('description') }}</mat-error>
        </mat-form-field>

        <!-- Identity Source Configuration Section -->
        <h3 class="section-title">Identity Source Configuration</h3>
        <mat-divider></mat-divider>
        
        <mat-form-field appearance="outline">
            <mat-label>Provider Name</mat-label>
            <input matInput formControlName="providerName" placeholder="e.g., OPTIMA">
            <mat-error>{{ getErrorMessage('providerName') }}</mat-error>
        </mat-form-field>
        
        <mat-form-field appearance="outline">
            <mat-label>API Base URL</mat-label>
            <input matInput formControlName="apiBaseUrl" placeholder="https://api.provider.com/v1">
            <mat-error>{{ getErrorMessage('apiBaseUrl') }}</mat-error>
        </mat-form-field>

        <mat-form-field appearance="outline" class="full-width-field">
            <mat-label>Client ID</mat-label>
            <input matInput formControlName="clientId">
            <mat-error>{{ getErrorMessage('clientId') }}</mat-error>
        </mat-form-field>

        <mat-form-field appearance="outline" class="full-width-field">
            <mat-label>Encrypted Client Secret</mat-label>
            <input matInput formControlName="clientSecretEncrypted">
            <mat-error>{{ getErrorMessage('clientSecretEncrypted') }}</mat-error>
        </mat-form-field>
        
        <mat-form-field appearance="outline">
            <mat-label>AES Key</mat-label>
            <input matInput formControlName="aesKey">
            <mat-error>{{ getErrorMessage('aesKey') }}</mat-error>
        </mat-form-field>
        
        <mat-form-field appearance="outline">
            <mat-label>Initialization Vector (IV)</mat-label>
            <input matInput formControlName="iv">
            <mat-error>{{ getErrorMessage('iv') }}</mat-error>
        </mat-form-field>

      </form>
    </mat-card-content>

    <mat-card-actions align="end">
      <button mat-stroked-button type="button" (click)="onCancel()" [disabled]="isLoading">
        Cancel
      </button>
      <button mat-flat-button class="primary-button" type="submit" [disabled]="tenantForm.invalid || isLoading" (click)="onSubmit()">
        <div class="button-content">
          <mat-spinner *ngIf="isLoading" diameter="20"></mat-spinner>
          <mat-icon *ngIf="!isLoading">{{ isEditMode ? 'save' : 'add' }}</mat-icon>
          <span>{{ isEditMode ? 'Update Tenant' : 'Create Tenant' }}</span>
        </div>
      </button>
    </mat-card-actions>
  </mat-card>
</div>